# Solana ITS vX.Y.Z

|                | **Owner**                      |
| -------------- | ------------------------------ |
| **Created By** | @<GITHUB_USERNAME> (<EMAIL>)   |
| **Deployment** | @<GITHUB_USERNAME> (<EMAIL>)   |

| **Network**          | **Deployment Status** | **Date**         |
| -------------------- | --------------------- | ---------------- |
| **Devnet Amplifier** | Pending               | <DEPLOY_DATE>    |
| **Stagenet**         | Pending               | <DEPLOY_DATE>    |
| **Testnet**          | Pending               | <DEPLOY_DATE>    |
| **Mainnet**          | Pending               | <DEPLOY_DATE>    |

- [GitHub Release](<GITHUB_RELEASE_URL>)

## Background

This is the vX.Y.Z Solana ITS release, bringing Interchain Token Service capabilities to the Solana blockchain.

## Deployment

Ensure that [Solana GMP](../solana/2025-05-GMP-vX.Y.Z.md) is deployed first.

### Set Up Environment

Create an `.env` config:

```yaml
# Set private key and network
PRIVATE_KEY=<SOLANA_DEPLOYER_KEY>
ENV=<devnet-amplifier|stagenet|testnet|mainnet>
CHAIN=<solana-testnet|solana>  # Use solana-testnet for devnet-amplifier, stagenet, testnet; use solana for mainnet
```

### Deployment Steps

1. Generate Solana keypair for ITS program (if not already done):

```sh
solana-keygen new -o <PATH_TO_ITS_PROGRAM_KEYPAIR>
```

2. Deploy Interchain Token Service:

```sh
solana program-v4 deploy \
  --program-keypair <PATH_TO_ITS_PROGRAM_KEYPAIR> \
  --authority <AUTHORITY_PUBKEY> \
  solana-axelar/solana/target/sbf-solana-solana/release/axelar_solana_its.so
```

3. Initialize ITS:

```sh
solana/solana-axelar-cli send its init --operator <OPERATOR_PUBKEY>
```

4. Register Solana ITS on ITS Hub:

ITS hub contract configuration in `$ENV.json` must include the following attributes per chain:

```json
"axelar": {
  "contracts": {
    "InterchainTokenService": {
      "$CHAIN": {
        "maxUintBits": 53,
        "maxDecimalsWhenTruncating": 255
      }
    }
  }
}
```

Please refer to `$DEPOSIT_VALUE` and `$RUN_AS_ACCOUNT` from Amplifier deployment documentation.

- `--runAs $RUN_AS_ACCOUNT` is only required for devnet-amplifier. Do not use `--runAs` for stagenet, testnet, or mainnet.
- For mainnet, add a community post for the proposal.

```sh
node cosmwasm/submit-proposal.js \
    its-hub-register-chains $CHAIN \
    -t "Register $CHAIN on ITS Hub" \
    -d "Register $CHAIN on ITS Hub" \
    --deposit $DEPOSIT_VALUE \
    --runAs $RUN_AS_ACCOUNT
```

5. Set up trusted chains on Solana:

```sh
# Add all trusted chains to Solana ITS
solana/solana-axelar-cli send its set-trusted-chain --chain-name all
```

Alternatively, add specific chains:

```sh
# Add a specific trusted chain
solana/solana-axelar-cli send its set-trusted-chain --chain-name <CHAIN_NAME>
```

6. Set Solana as trusted chain on EVM ITS and other chain ITS implementations:

```sh
# Change PRIVATE_KEY in .env to EVM
PRIVATE_KEY=<EVM_DEPLOYER_KEY>

node evm/its.js -n all --action setTrustedAddress --trustedChain $CHAIN --trustedAddress hub
```

## Checklist

The following checks should be performed after the rollout.

### Execute Command

The GMP call needs to be routed via Amplifier before the `execute` call.

### Solana to EVM

- Note: The final execute step of the GMP call on EVM can be performed via:

```sh
# Change PRIVATE_KEY in .env to EVM
PRIVATE_KEY=<EVM_DEPLOYER_KEY>

node evm/gateway.js -n <DESTINATION_CHAIN> --action execute --payload <PAYLOAD> --sourceChain axelar --sourceAddress <ITS_HUB_ADDRESS> --messageId <MESSAGE_ID> --destination <DESTINATION_ADDRESS>
```

1. Deploy Native Interchain Token:

```sh
solana/solana-axelar-cli send its deploy-interchain-token \
  --salt <SALT_STRING> \
  --name <TOKEN_NAME> \
  --symbol <TOKEN_SYMBOL> \
  --decimals <DECIMALS> \
  --initial-supply <INITIAL_SUPPLY>

solana/solana-axelar-cli send its deploy-remote-interchain-token \
  --salt <SALT_STRING> \
  --destination-chain <DESTINATION_CHAIN_NAME> \
  --gas-value <GAS_VALUE>
```

2. Interchain Token Transfer for Native Interchain Token:

```sh
solana/solana-axelar-cli send its interchain-transfer \
  --source-account <SOURCE_ACCOUNT_ADDRESS> \
  --token-id <TOKEN_ID_HEX> \
  --destination-chain <DESTINATION_CHAIN_NAME> \
  --destination-address <DESTINATION_ADDRESS> \
  --amount <AMOUNT> \
  --mint <MINT_ADDRESS> \
  --token-program <TOKEN_PROGRAM> \
  --gas-value <GAS_VALUE>
```

3. Deploy Remote Canonical Token:

```sh
solana/solana-axelar-cli send its register-canonical-interchain-token \
  --mint <MINT_ADDRESS> \
  --token-program <TOKEN_PROGRAM>

solana/solana-axelar-cli send its deploy-remote-canonical-interchain-token \
  --mint <MINT_ADDRESS> \
  --destination-chain <DESTINATION_CHAIN_NAME> \
  --gas-value <GAS_VALUE>
```

4. Interchain Token Transfer for Canonical Token:

```sh
solana/solana-axelar-cli send its interchain-transfer \
  --source-account <SOURCE_ACCOUNT_ADDRESS> \
  --token-id <TOKEN_ID_HEX> \
  --destination-chain <DESTINATION_CHAIN_NAME> \
  --destination-address <DESTINATION_ADDRESS> \
  --amount <AMOUNT> \
  --mint <MINT_ADDRESS> \
  --token-program <TOKEN_PROGRAM> \
  --gas-value <GAS_VALUE>
```

### EVM to Solana

- Note: The final execute step of the GMP call on Solana can be performed via:

```sh
# Change PRIVATE_KEY in .env to Solana
PRIVATE_KEY=<SOLANA_DEPLOYER_KEY>

solana/solana-axelar-cli send its execute \
  --source-chain <SOURCE_CHAIN> \
  --message-id <MESSAGE_ID> \
  --source-address <SOURCE_ADDRESS> \
  --payload <PAYLOAD>
```

1. Deploy Native Interchain Token:

```sh
node evm/interchainTokenFactory.js --action deployInterchainToken -n <SOURCE_CHAIN> --destinationChain $CHAIN --salt <SALT> --name <TOKEN_NAME> --symbol <TOKEN_SYMBOL> --decimals <DECIMALS>

node evm/interchainTokenFactory.js --action deployRemoteInterchainToken -n <SOURCE_CHAIN> --destinationChain $CHAIN --salt <SALT> --gasValue <GAS_VALUE>
```

2. Interchain Token Transfer for Native Interchain Token:

```sh
node evm/its.js --action interchainTransfer -n <SOURCE_CHAIN> --destinationChain $CHAIN --destinationAddress <ENCODED_RECIPIENT> --tokenId <TOKEN_ID> --amount <AMOUNT>
```

3. Deploy Remote Canonical Token:

```sh
node evm/interchainTokenFactory.js --action registerCanonicalInterchainToken -n <SOURCE_CHAIN> --destinationChain $CHAIN --tokenAddress <TOKEN_ADDRESS>

node evm/interchainTokenFactory.js --action deployRemoteCanonicalInterchainToken -n <SOURCE_CHAIN> --destinationChain $CHAIN --tokenAddress <TOKEN_ADDRESS> --gasValue <GAS_VALUE>
```

4. Interchain Token Transfer for Canonical Token:

```sh
node evm/its.js --action interchainTransfer -n <SOURCE_CHAIN> --destinationChain $CHAIN --destinationAddress <ENCODED_RECIPIENT> --tokenId <TOKEN_ID> --amount <AMOUNT> --gasValue <GAS_VALUE>
```

### Additional Checks

- Verify token minting/burning on Solana
- Verify token transfers between Solana and other chains
- Test flow limits and pausable functionality if implemented