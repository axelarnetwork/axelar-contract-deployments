# Solana GMP v1.0.0

|                | **Owner**                      |
| -------------- | ------------------------------ |
| **Created By** | @<GITHUB_USERNAME> (<EMAIL>)   |
| **Deployment** | @<GITHUB_USERNAME> (<EMAIL>)   |

| **Network**          | **Deployment Status** | **Date**         |
| -------------------- | --------------------- | ---------------- |
| **Devnet Amplifier** | Pending               | <DEPLOY_DATE>    |
| **Stagenet**         | Pending               | <DEPLOY_DATE>    |
| **Testnet**          | Pending               | <DEPLOY_DATE>    |
| **Mainnet**          | Pending               | <DEPLOY_DATE>    |

- [GitHub Release](<GITHUB_RELEASE_URL>)

## Background

This is the v1.0.0 Solana GMP release, introducing General Message Passing (GMP) capabilities for Solana blockchain.

## Deployment

### Prerequisites

1. Install Solana CLI:

```sh
sh -c "$(curl -sSfL https://release.anza.xyz/stable/install)"
```

2. Clone the solana-axelar repository.

3. Build the Solana programs:

```sh
# Go to the solana directory within the cloned repo
pushd solana-axelar/solana/

# Compile the Solana programs
cargo xtask build

# Go back
popd
```

4. Set up environment configuration:

```sh
# Set default cluster
solana config set --url testnet # Use appropriate network: testnet, devnet, mainnet-beta, or localhost

# Generate a new keypair if needed
solana-keygen new 

# Get funds
solana airdrop 2
```

### Initial Solana Config

Add Solana chain config to the `axelar-chains-config/info/<devnet-amplifier|testnet|mainnet>.json` file under the `chains` key.

#### Devnet-amplifier:

```json
"solana-devnet": {
  "name": "Solana Devnet",
  "axelarId": "solana-devnet",
  "rpc": "https://api.devnet.solana.com",
  "chainType": "svm",
  "decimals": 9,
  "finality": TBD,
  "approxFinalityWaitTime": 13,
  "tokenSymbol": "SOL",
  "explorer": {
    "name": "Solana Explorer",
    "url": "https://explorer.solana.com/?cluster=devnet"
  },
  "contracts": {}
}
```

#### Testnet:

```json
"solana-testnet": {
  "name": "Solana Testnet",
  "axelarId": "solana-testnet",
  "rpc": "https://api.testnet.solana.com",
  "chainType": "svm",
  "decimals": 9,
  "finality": TBD,
  "approxFinalityWaitTime": 13,
  "tokenSymbol": "SOL",
  "explorer": {
    "name": "Solana Explorer",
    "url": "https://explorer.solana.com/?cluster=testnet"
  },
  "contracts": {}
}
```

#### Mainnet:

```json
"solana": {
  "name": "Solana",
  "axelarId": "solana",
  "rpc": "https://api.mainnet-beta.solana.com",
  "chainType": "svm",
  "decimals": 9,
  "finality": TBD,
  "approxFinalityWaitTime": 13,
  "tokenSymbol": "SOL",
  "explorer": {
    "name": "Solana Explorer",
    "url": "https://explorer.solana.com/"
  },
  "contracts": {}
}
```

### Deployment Steps

1. Deploy Gateway program:

```sh
solana program-v4 deploy \
  --program-keypair <PATH_TO_GATEWAY_PROGRAM_KEYPAIR> \
  --authority <AUTHORITY_PUBKEY> \
  solana-axelar/solana/target/sbf-solana-solana/release/axelar_solana_gateway.so
```

2. Deploy Gas Service program:

```sh
solana program-v4 deploy \
  --program-keypair <PATH_TO_GAS_SERVICE_PROGRAM_KEYPAIR> \
  --authority <AUTHORITY_PUBKEY> \
  solana-axelar/solana/target/sbf-solana-solana/release/axelar_solana_gas_service.so
```

3. Deploy Governance program:

```sh
solana program-v4 deploy \
  --program-keypair <PATH_TO_GOVERNANCE_PROGRAM_KEYPAIR> \
  --authority <AUTHORITY_PUBKEY> \
  solana-axelar/solana/target/sbf-solana-solana/release/axelar_solana_governance.so
```

4. Deploy Multicall program:

```sh
solana program-v4 deploy \
  --program-keypair <PATH_TO_MULTICALL_PROGRAM_KEYPAIR> \
  --authority <AUTHORITY_PUBKEY> \
  solana-axelar/solana/target/sbf-solana-solana/release/axelar_solana_multicall.so
```

5. After deploying Solana contracts, deploy the [Solana GMP Amplifier](../cosmwasm/2025-05-Solana-GMP-v1.0.0.md).

### Initialization Steps

1. Initialize Gateway:

| Network              | `minimumRotationDelay` | `previousSignersRetention` |
| -------------------- | ---------------------- | -------------------------- |
| **Devnet-amplifier** | TBD                    | TBD                        |
| **Testnet**          | TBD                    | TBD                        |
| **Mainnet**          | TBD                    | TBD                        |


```sh
solana/solana-axelar-cli send gateway init \
  --previous-signers-retention <RETENTION_COUNT> \
  --minimum-rotation-delay <DELAY_IN_SECONDS> \
  --operator <OPERATOR_PUBKEY>
```

This will query the `MultisigProver` for the `VerifierSet`. Thus, the Solana `MultisigProver` must be deployed before this step and its information available within the appropriate object in the `axelar-chains-config/info/<devnet-amplifier|testnet|mainnet>.json` file.

## Checklist

The following checks should be performed after the rollout:

### Verify Solana → EVM GMP call

1. Send a GMP call:

```sh
solana/solana-axelar-cli send gateway call-contract \
  --destination-chain <DESTINATION_CHAIN_NAME> \
  --destination-address <DESTINATION_ADDRESS> \
  --payload <MESSAGE_PAYLOAD_HEX>
```

2. Route GMP call via Amplifier:

- <https://docs.axelar.dev/dev/amplifier/chain-integration/relay-messages>

3. Submit proof with multisig session ID:

```sh
# Set PRIVATE_KEY within .env
PRIVATE_KEY=<EVM_DEPLOYER_KEY>

node evm/gateway.js -n <DESTINATION_CHAIN> --action submitProof --multisigSessionId <MULTISIG_SESSION_ID>
```

4. Confirm message approval:

```sh
node evm/gateway.js -n <DESTINATION_CHAIN> --action isContractCallApproved --commandID <COMMAND_ID> --sourceChain <solana|solana-testnet|solana-devnet> --sourceAddress <SOURCE_ADDRESS> --destination <DESTINATION_ADDRESS> --payloadHash <PAYLOAD_HASH>
```

### Verify EVM → Solana GMP Call

1. Send a GMP call:

```sh
node evm/gateway.js -n <SOURCE_CHAIN> --action callContract --destinationChain <solana|solana-testnet|solana-devnet> --destination <DESTINATION_ADDRESS> --payload <PAYLOAD_HEX>
```

2. Route GMP call via Amplifier:

- <https://docs.axelar.dev/dev/amplifier/chain-integration/relay-messages>

3. Submit proof with multisig session ID:

```sh
solana/solana-axelar-cli send gateway submit-proof \
  --multisig-session-id <MULTISIG_SESSION_ID>
```

4. Execute message:

```sh
solana/solana-axelar-cli send gateway execute \
  --source-chain <SOURCE_CHAIN_NAME> \
  --message-id <MESSAGE_ID> \
  --source-address <SOURCE_ADDRESS> \
  --destination-address <DESTINATION_PUBKEY> \
  --payload <PAYLOAD_HEX>
```
