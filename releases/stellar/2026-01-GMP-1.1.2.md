# Stellar GMP v1.1.2

|                | **Owner**                             |
| -------------- | ------------------------------------- |
| **Created By** | @rista404 (<ristic@commonprefix.com>) |
| **Deployment** | TBD                                   |

| **Network**  | **Deployment Status** | **Date** |
| ------------ | --------------------- | -------- |
| **Stagenet** | TBD                   | TBD      |
| **Testnet**  | TBD                   | TBD      |


- [Crates](https://crates.io/crates/stellar-axelar-gateway/1.1.2)
- [Releases](https://github.com/axelarnetwork/axelar-amplifier-stellar/releases/tag/stellar-axelar-gateway-v1.1.2)

## Background & Deployment

This deployment is being performed due to the Stellar testnet reset on December 17 at 17:00 UTC,
Only for stagenet and testnet environments - not devnet-amplifier and mainnet.

Create an `.env` config. `CHAIN` should be set to `stellar-2025-q4` for stagenet and testnet.

> [!TIP]
> rista404:
> `stellar keys secret [name]`

```yaml
# Change `PRIVATE_KEY in `.env` to Stellar
PRIVATE_KEY=<stellar_deployer_key>
ENV=<stagenet|testnet>
CHAIN=stellar-2025-q4
```

An initial Stellar chain config needs to be added to `${ENV}.json` file under `chains` key.

#### Stagenet / Testnet

```json
"$CHAIN": {
    "name": "Stellar",
    "axelarId": "$CHAIN",
    "rpc": "https://soroban-testnet.stellar.org",
    "horizonRpc": "https://horizon-testnet.stellar.org",
    "networkType": "testnet",
    "chainType": "stellar",
    "decimals": 7,
    "finality": "1",
    "approxFinalityWaitTime": 1,
    "tokenSymbol": "XLM",
    "tokenAddress": "CDLZFC3SYJYDZT7K67VZ75HPJVIEUVNIXF47ZG2FB2RMQQVU2HHGCYSC",
    "explorer": {
      "name": "Stellar Expert",
      "url": "https://stellar.expert/explorer/testnet"
    },
  "contracts": {}
  }
```

#### Contract Version Info

> [!TIP]
> rista404: add tips to get these versions from crates.io or github releases

| Contract           | **Stagenet** | **Testnet** |
| ------------------ | ------------ | ----------- |
| `AxelarGateway`    | `1.1.2`      | `1.1.2`     |
| `AxelarOperators`  | `1.1.2`      | `1.1.2`     |
| `AxelarGasService` | `1.1.2`      | `1.1.2`     |
| `AxelarExample`    | `1.0.7`      | `1.0.7`     |
| `Upgrader`         | `1.1.2`      | `1.1.2`     |

Set `$VERSION` to the appropriate version from the table above for your target environment.

> [!TIP]
> rista404: instruction above unclear. we should mention the `$VERSION` below isn't an env var but value for each of the contract. also, instructions should mention where can we get the latest versions of each contract

1. Request Tokens from Faucet

```bash
ts-node stellar/faucet.js
```

2. Verify deployer address

| Network      | `deployer address`                                         |
| ------------ | ---------------------------------------------------------- |
| **Stagenet** | `GCYQEKUIMIYDN3CSXAG55STYOLMIFPYRIAZSCETGQCFTHIL4GSBXB6MV` |
| **Testnet**  | `GAFUP3J3M2QNUQZA4ZO744IGCHFKMOCYXR2JQ2UQW65IKWG5OCVTXR3L` |

3. Deploy Gateway

| Network      | `minimumRotationDelay` | `previousSignersRetention` |
| ------------ | ---------------------- | -------------------------- |
| **Stagenet** | `300`                  | `15`                       |
| **Testnet**  | `3600`                 | `15`                       |

```bash
ts-node stellar/deploy-contract deploy AxelarGateway --version $VERSION --minimum-rotation-delay [minimum-rotation-delay] --previous-signers-retention 15
```

4. Deploy Operators

| Network      | `deployer address`                                         |
| ------------ | ---------------------------------------------------------- |
| **Stagenet** | `GCYQEKUIMIYDN3CSXAG55STYOLMIFPYRIAZSCETGQCFTHIL4GSBXB6MV` |
| **Testnet**  | `GAFUP3J3M2QNUQZA4ZO744IGCHFKMOCYXR2JQ2UQW65IKWG5OCVTXR3L` |

```bash
ts-node stellar/deploy-contract deploy AxelarOperators --version $VERSION
```

5. Deploy Gas Service

```bash
ts-node stellar/deploy-contract deploy AxelarGasService --version $VERSION
```

6. Deploy Example with dummy ITS address

```bash
ts-node stellar/deploy-contract deploy AxelarExample --version $VERSION --use-dummy-its-address
```

7. Deploy Upgrader

```bash
ts-node stellar/deploy-contract deploy Upgrader --version $VERSION
```

8. Once the Stellar contracts are deployed, deploy [Stellar GMP Amplifier](../cosmwasm/2025-01-Stellar-GMP-v1.0.0.md) using the same process, with the only differences being the chain name and the Stellar gateway address.
