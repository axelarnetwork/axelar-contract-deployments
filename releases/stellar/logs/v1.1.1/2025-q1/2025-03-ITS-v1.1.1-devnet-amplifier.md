# Stellar ITS v1.1.1

## Steps

### Upload TokenManager & retrieve WASM hash

```bash
ts-node stellar/deploy-contract.js upload TokenManager --version 1.1.1

Uploaded TokenManager wasm tx: a940b26a580c6e22ee936e52970879442705b39c64e40c38663b60cf684df200

Contract uploaded successfully: {
"contractName": "TokenManager",
"wasmHash": "9883cdb6740d685007a88dbd5a1269ffc1550a81a182fed5de3748356d0e342c"
}
```

### Upload InterchainToken & retrieve WASM hash

```bash
ts-node stellar/deploy-contract.js upload InterchainToken --version 1.1.1
Uploaded InterchainToken wasm tx: 4f0644d7a818571b41651c3ed82d582a5de68b401aaa7cdf2db1ad4f6c8a2e3f

Contract uploaded successfully: {
"contractName": "InterchainToken",
"wasmHash": "71648e1b8ee1231ea03c096257ed3c6d55478effbfab77b8e587a5139ab84cbe"
}
```

### Upgrade InterchainTokenService & migrate storage schema

```bash
ts-node stellar/deploy-contract.js upgrade InterchainTokenService --version 1.1.1 --migration-data '{"newTokenManagerWasmHash":"9883cdb6740d685007a88dbd5a1269ffc1550a81a182fed5de3748356d0e342c","newInterchainTokenWasmHash":"71648e1b8ee1231ea03c096257ed3c6d55478effbfab77b8e587a5139ab84cbe"}'

Upgraded contract tx: 8ce3228982eff9f24a6d9c99e89c8af2a19506e54aca98e7c1caf0bf09bf31c2
```

```bash
ts-node stellar/deploy-contract.js upgrade InterchainTokenService --version 1.1.2 --migration-data '{"newTokenManagerWasmHash":"9883cdb6740d685007a88dbd5a1269ffc1550a81a182fed5de3748356d0e342c","newInterchainTokenWasmHash":"71648e1b8ee1231ea03c096257ed3c6d55478effbfab77b8e587a5139ab84cbe"}'

Upgraded contract tx: b29172c404b3b55a8ba98441c10e2af0c2455fd8b2901ce659356791936ea7c6

```

### Call ITS::migrate_token for ALL deployed tokenIds (base64)

```bash
ts-node stellar/its.js migrate-tokens "Ti+Y+1SPlMl6ZvSfJSq1lTJna8pWcboxzVkujlT0/F0=" "J535ZSKoVNJdPK0QfK4QNZtrlGDrRoDaTmXV59EqXq0=" "bFaSJThTT7kJQzooI+f4g992m1LpEacDWN20EBHQ3ro=" "jC5tzI2Z+ljSXkwbNbkKMnWlWo59Pk+E2K5gdYOfna4=" "25L0WIB2ChfMc3cFtRM+oOzIJaEQfs+61S9DqJ+WqAw=" "sy1A5j5i5v43b84Zvz6ed57K3Dyb5pI+T+4oKVXbl2Q=" "DLFdu9+hYIW0XgkQTMSF5lSaI/cKdmSnoTn75jZbv8A=" "caBrwGL0ROiIbKS5sn7rSVTC6idQmOvsfx7E+cUpI10=" "MJlVSFxI9myqmYe0kPZAM0DZ82x+7qMHKqijO9Lq89o=" "w3yhg24JHcNlkpZ585AEdw7pc1s3BuDlcFXtQBCoibE=" "wTusnWDmOBMA0jtpoUzBTeSCOA6CDH4yzWZVakASQtk=" --version 1.1.1

Migrating token: 0x4e2f98fb548f94c97a66f49f252ab59532676bca5671ba31cd592e8e54f4fc5d

Upgrader address: CAB7HFMRI67WGOWO5DGVO4OUMGOW2LT2CVPSMF5ALYOA4JSNR3O2MGIQ

Retrieved TokenManager address tx: 011c301d6462a501909ff0fac4d06cfff7b83df43a44674dfb7f4bae2cf77cdd

TokenManager address: CCCST4JAROEIDEBGXV4XQQJU7VHUGZLST2WKQU5XKG5YSFM5IPIDQ3HO

Retrieved InterchainToken address tx: 78bc8327d865ad67989241d32a53bf99d231a54bd9e50ef59316c6112f067f0a

InterchainToken address: CABZ7JCQ6277GSPS6EO63PHXNC7NWOA5IUBFLFXL7RNM65M7VP6GIS6B

Migrated token tx: ab997877a1167ff909cf3c2df9a1ffaab26873cf7db3abf8b4051f07aec3411e

Migrating token: 0x279df96522a854d25d3cad107cae10359b6b9460eb4680da4e65d5e7d12a5ead

Upgrader address: CAB7HFMRI67WGOWO5DGVO4OUMGOW2LT2CVPSMF5ALYOA4JSNR3O2MGIQ

Retrieved TokenManager address tx: aa1c024b3a8b83c8dcaa08e249cfe8171fce2c9467540d84dd2d2173a3179856

TokenManager address: CDXPB6QDXODSFEZZQM4USGRHYQIPLCSEMY3M5BVAC3RWZ7L662JEK7CM

Retrieved InterchainToken address tx: e9697fdaeaab053220f7acf19e052c2cbf4d09366648a37948c6a49290ade5cb

InterchainToken address: CBXN4QR5QSPFH3UBL2BB233NTHO5MTFBGODEGQUE2P4WR4KIB3GO6A3X

Migrated token tx: b1f69f35e50b86fc2feabce4795a34875004e0f61fbfe9eff6b9b3f30fbfa9af

Migrating token: 0x6c56922538534fb909433a2823e7f883df769b52e911a70358ddb41011d0deba

Upgrader address: CAB7HFMRI67WGOWO5DGVO4OUMGOW2LT2CVPSMF5ALYOA4JSNR3O2MGIQ

Retrieved TokenManager address tx: 6b165ee2caed9d7a5c9750500f93cd507e3ac6237feb124f2da5f990ffc5a2bd

TokenManager address: CD5LKBHER62RQVJXUNVE74O3Q2IIXQEWAEQVXVU6LR6WFVTQEUOX37KO

Retrieved InterchainToken address tx: 5dfc13869c892af1499a966e960ff1a230e475a081a1bebb9af863b4f5821ed7

InterchainToken address: CABAY326266EVWJP3E2NQYZZ6552ZB2ZDWOYXZLM67D6DZBQ5VJMDXIU

Migrated token tx: 1f93753a1b15bf91b5ed0e092a378ca3ccf34a5e53495f5dd324df81746bb412

Migrating token: 0x8c2e6dcc8d99fa58d25e4c1b35b90a3275a55a8e7d3e4f84d8ae6075839f9dae

Upgrader address: CAB7HFMRI67WGOWO5DGVO4OUMGOW2LT2CVPSMF5ALYOA4JSNR3O2MGIQ

Retrieved TokenManager address tx: 33fa60f893a31805261b69f1f9704af743534c6bd2f5f3c8b03919d98b314aa0

TokenManager address: CAP4YU4D45LR5EKMLHOQV3K6YZBCJTSE2AYS6LUEYWYKGTDVU54XJVPK

Retrieved InterchainToken address tx: 7eef3c2703d5b0be2063be402f5cdbdf8a7c62c3337b97106289f921bfafdce4

InterchainToken address: CDBAG6WO6SJ7ANPU57YXIZNDFOOAUNPAWJSRGJA7V6G7GJBNDCA5ZKCX

Migrated token tx: 4406c93b21eb74f4280eed57560610c2badb6fbfd1f3b69d63cec8ff8f93008b

Migrating token: 0xdb92f45880760a17cc737705b5133ea0ecc825a1107ecfbad52f43a89f96a80c

Upgrader address: CAB7HFMRI67WGOWO5DGVO4OUMGOW2LT2CVPSMF5ALYOA4JSNR3O2MGIQ

Retrieved TokenManager address tx: 9f0909d27ba6c122ba661d31c5494186701a08683f8ab4d46c15d49a71043676

TokenManager address: CA5QTBX2YRTYPI7XK2U2BOLH5S4YCQHNCU2JLEVCBVRJ46Z3XYGLRVBM

Retrieved InterchainToken address tx: cec784a8e74b5f36d156b0d9fb8d93a185d7ba16fa9271858a8e833ba35309f8

InterchainToken address: CA74TEICYMISJGYNTGN4DNIMJUKCTBKGYKV7TM54GBZ2CPQRBPDRP3IG

Migrated token tx: 6b23acdb31eb263643e1edfd2581e56c924012b4eed970ccf1300c055fc7457d

Migrating token: 0xb32d40e63e62e6fe376fce19bf3e9e779ecadc3c9be6923e4fee282955db9764

Upgrader address: CAB7HFMRI67WGOWO5DGVO4OUMGOW2LT2CVPSMF5ALYOA4JSNR3O2MGIQ

Retrieved TokenManager address tx: 35ebe8e630083374340b889d53850bd9a8213e5239bbf4b2a7d44306090ee2f8

TokenManager address: CD4T4YW56CQA3CO6NW422WJC5AJVDA3G4G2US4MRPHRRW3PWTJKEOX3P

Retrieved InterchainToken address tx: d838a201902f84fbf5673b292f83b9a93162bb8c2a23125bb06fa3b1fe767a53

InterchainToken address: CDLNR3OAANJPAGIXHJZ26BWMEN5KHL2IAIM46ZHL6C2ZVZ6VXHHF5DN4

Migrated token tx: a4b79b9b87ffa8d96ceb49c06e991df3046b3548a8256bbf94ce613e0989074a

Migrating token: 0x0cb15dbbdfa16085b45e09104cc485e6549a23f70a7664a7a139fbe6365bbfc0

Upgrader address: CAB7HFMRI67WGOWO5DGVO4OUMGOW2LT2CVPSMF5ALYOA4JSNR3O2MGIQ

Retrieved TokenManager address tx: d167e0b343813d26b3d54042a284941ead7fb1420100bb89325b3394dec556ba

TokenManager address: CATYCPEXXQJ7SMEAPFA6N3G4YZGIHO4EP3I2EONQQ7GG7TIVPJBMHNMP

Retrieved InterchainToken address tx: c7207797f4eb70087582a521a3449319142afe15e169aae319625d6fb98c939b

InterchainToken address: CDK73SDGPQAS3ZMEMIL5JPZHE5Z72GTC2K64KQWHE65XA3ZUWDH6R5H7

Migrated token tx: b83ebd70133a100447053402091c726acf0f6f37fe13fab1cf3057fbb4b80215

Migrating token: 0x71a06bc062f444e8886ca4b9b27eeb4954c2ea275098ebec7f1ec4f9c529235d

Upgrader address: CAB7HFMRI67WGOWO5DGVO4OUMGOW2LT2CVPSMF5ALYOA4JSNR3O2MGIQ

Retrieved TokenManager address tx: 7cd42b7c53401e5ceaadb871f2d0b2d88bae7d4b915862588988f539688e1b2e

TokenManager address: CDJBOSCRTPISW66FX3ZA2PLSJCLGZD2KJ5RRMR5C67M57PGHI7ZIMN2P

Retrieved InterchainToken address tx: 3b097e2cc7e74bd0703efaf3b6991e178e0baf2183d367f898b715d30b4ddf75

InterchainToken address: CDUEART35X26IWSY57XYKTHXF6AYUGXUWPSTFT2YPXZTOMU53NJBF2UC

Migrated token tx: e5947a77dccc1fc40302389db25cdabc1bd485d38184e3b1d7cbad4ba60c9107

Migrating token: 0x309955485c48f66caa9987b490f6403340d9f36c7eeea3072aa8a33bd2eaf3da

Upgrader address: CAB7HFMRI67WGOWO5DGVO4OUMGOW2LT2CVPSMF5ALYOA4JSNR3O2MGIQ

Retrieved TokenManager address tx: b50ecc15c8063bcc4761250928af4101f31526b70a51ad46b6ba828e6435443d

TokenManager address: CCUINMSNY6LXRUN34SKAAVF77TWZJSF577GLBL65VTZEAAH6GIK42ZGR

Retrieved InterchainToken address tx: 499eb445d245ae5fff80e1e19d4daa8b5e43c0f4733e6a01a52d8ceb6d17322e

InterchainToken address: CBO3VU6TBD3CY5FFQILIFNYPIYBYOJX4P77B5ZBGWMMCOMCIVZRNU3EX

Migrated token tx: be7c5056c13f02252fbfb5cbe477f9349f906932d4c0e06865f7aae507f096c1

Migrating token: 0xc37ca1836e091dc365929679f39004770ee9735b3706e0e57055ed4010a889b1

Upgrader address: CAB7HFMRI67WGOWO5DGVO4OUMGOW2LT2CVPSMF5ALYOA4JSNR3O2MGIQ

Retrieved TokenManager address tx: fe6830d07e62281d71423c1c899989f15b15c673b6f0463f8f0e92f784932002

TokenManager address: CBC4KZBJJDRXNO77RAOCLV3GEIAINIFXALRKRNIDQ7LLU6KP7AH3AIKL

Retrieved InterchainToken address tx: e98a9a4fca50af057709f4b4ccab32fc7f7d29f0fd7f6c1a3a5fe93239b3d8e9

InterchainToken address: CDRGJ6ILQFP5JH6JHWRTPQOZDB3EWWYQQJXQCGEHNSM3I63YX74NQXRW

Migrated token tx: 1761dca3970f65e15c921fc92371a9c8234fae4f55ce6f59cad548f8dadc1579

Migrating token: 0xc13bac9d60e6381300d23b69a14cc14de482380e820c7e32cd66556a401242d9

Upgrader address: CAB7HFMRI67WGOWO5DGVO4OUMGOW2LT2CVPSMF5ALYOA4JSNR3O2MGIQ

Retrieved TokenManager address tx: 3eda5c436fc110a19bee23a65ae0cfc1e03276079163e23cf4c40eaef03ea418

TokenManager address: CC5XGSRHHYE2BX6PUQSWQUP4IG5HASD72EX7AYFOYVS57VNRWZXHQEHU

Retrieved InterchainToken address tx: 4c4ed28dc3cd7b0231776bedab45dc1ff6bebde19959bbb1f461d24758c1badd

InterchainToken address: CCGZCEDK6I4OXRRMR6K42RA6P6BOSTCXCLYCJGWRUIGPXUJGLE65LUVV

Migrated token tx: e514e899c9a6505e5f780e961a82cdaeb1f5eb716d75c64defe0ca5793560160
```

### Deploy Upgrader

```bash
ts-node stellar/deploy-contract.js deploy Upgrader --version 1.1.1

Initialized contract tx: 1897e3904d6a9b51ce00ac38e3de2bc6b39042d358264970674b36c9d05f987b
```

## Checklist

### Stellar → EVM

```bash
ts-node stellar/its.js deploy-interchain-token TEST2 test2 18 0x5678 100

Interchain Token Deployed tx: fe30dc0304fd49b77c96a27c683b1dc742afa7b0448c03552c05629d0d97844b
```

```bash
ts-node stellar/its.js deploy-remote-interchain-token 0x1234 avalanche-fuji --gas-amount 10000000

https://devnet-amplifier.axelarscan.io/gmp/9005da63ec6e6791f6d45ce41e46d3de8b2740c26578ca1b749c72166fbf9319
```

### EVM → Stellar

```bash
ts-node evm/interchainTokenFactory.js --action deployInterchainToken -n avalanche-fuji --destinationChain stellar-2025-q1 --salt "testa1" --name "testa1" --symbol "TESTA1" --decimals 18

deployInterchainToken tx: 0x92eeff8fa20fb58dd85d99934307fa67317fb95dc88ca20a9ff01293d88ffd98
```

```bash
Token address: 0x68F1bC3C45a9e03C148F02C33baCEd48A0a7F737
ts-node evm/interchainTokenFactory.js --action deployRemoteInterchainToken -n avalanche-fuji --destinationChain stellar-2025-q1 --salt "testa1" --gasValue 1000000000000000000

https://devnet-amplifier.axelarscan.io/gmp/0x872c1477838361e1295b19dd753394b679fd280d721ad09568b973d14588345c
```
