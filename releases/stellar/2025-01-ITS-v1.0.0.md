# STELLAR ITS v1.0.0

|                | **Owner**                            |
| -------------- | ------------------------------------ |
| **Created By** | @ahramy <ahram@interoplabs.io>       |
| **Deployment** | @RiceAndMeet <steven@interoplabs.io> |

| **Network**          | **Deployment Status** | **Date** |
| -------------------- | --------------------- | -------- |
| **Devnet Amplifier** | -                     | TBD      |
| **Stagenet**         | -                     | TBD      |
| **Testnet**          | -                     | TBD      |
| **Mainnet**          | -                     | TBD      |

- [Crates](https://crates.io/users/interoplabs-ci)
- [Releases](https://github.com/axelarnetwork/axelar-cgp-stellar/releases)

## Background

Changes in the release:

1. This is the v1.0.0 initial ITS release.

## Deployment

Create an `.env` config.

```yaml
PRIVATE_KEY=xyz
ENV=xyz
CHAIN=stellar-2024-q4
```

```bash
# Deploy Interchain Token
node stellar/deploy-contract.js deploy interchain_token --version v1.0.0

# Deploy Token Manager
node stellar/deploy-contract.js deploy token_manager --version v1.0.0

# Deploy Interchain Token Service
node stellar/deploy-contract.js deploy interchain_token_service --version v1.0.0

# Set Trusted Chain
node stellar/its.js set-trusted-chain avalanche

# Deploy Example
node stellar/deploy-contract.js deploy example --version v1.0.0
```

## Checklist

The following checks should be performed after the rollout

### Stellar to EVM

- [ ] Deploy Native Interchain Token

```bash
node stellar/its.js deploy-interchain-token test test 18 0x1234 10000

node stellar/its.js deploy-remote-interchain-token 0x1234 avalanche CDLZFC3SYJYDZT7K67VZ75HPJVIEUVNIXF47ZG2FB2RMQQVU2HHGCYSC 1

axd tx wasm execute $GATEWAY '{"verify_messages":
      [{"cc_id":{
        "source_chain":"stellar",        "message_id":"0xa80f425a6f22649b5b07307b0a9414fbd683a1ed8034c61c6c78d322213c905a-3"},
        "destination_chain":"axelar",        "destination_address":"axelar13ehuhysn5mqjeaheeuew2gjs785f6k7jm8vfsqg3jhtpkwppcmzqtedxty",        "source_address":"CC4AGLL66N26OLIZVY5RJDGKSEY2I67PCYMJCP4ZTICAQPZ7CMX6MN7L",        "payload_hash":"117d88d356969bd4b9895d3e67d52a48f3889f142fea97005f4deabd874a9ca3"}]
    }' $ARGS


axd tx wasm execute $GATEWAY '{"route_messages":
      [{"cc_id":{
        "source_chain":"stellar",        "message_id":"0xa80f425a6f22649b5b07307b0a9414fbd683a1ed8034c61c6c78d322213c905a-3"},
        "destination_chain":"axelar",        "destination_address":"axelar13ehuhysn5mqjeaheeuew2gjs785f6k7jm8vfsqg3jhtpkwppcmzqtedxty",        "source_address":"CC4AGLL66N26OLIZVY5RJDGKSEY2I67PCYMJCP4ZTICAQPZ7CMX6MN7L",        "payload_hash":"117d88d356969bd4b9895d3e67d52a48f3889f142fea97005f4deabd874a9ca3"}]
    }' $ARGS

axd tx wasm execute axelar1zh7f9k0up9gtdjpqc9lhs60aujaww8nf5254zhphc7xyz56cus2s6ue8ya '{"execute":
      {"cc_id":{
        "source_chain":"stellar",        "message_id":"0xa80f425a6f22649b5b07307b0a9414fbd683a1ed8034c61c6c78d322213c905a-3"},
    "payload": "0000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000096176616c616e636865000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001600000000000000000000000000000000000000000000000000000000000000001a98974cd02e5ee3d65bff69465a00917f27176bffd72e352c11a78c7a999bded00000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000057465737435000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000574657374350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
}
    }' $ARGS

axd tx wasm execute $PROVER '{"construct_proof":[{"source_chain":"axelar","message_id":"0x1c297d6a2522aa9263d4ac034252486284d58f0c9badf1f0beb009b27c37ab1f-298"}]}' $ARGS

node evm/gateway.js -n avalanche --action submitProof --multisigSessionId 11

node evm/gateway.js -n avalanche --action execute --payload 0x0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000077374656c6c61720000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001600000000000000000000000000000000000000000000000000000000000000001a98974cd02e5ee3d65bff69465a00917f27176bffd72e352c11a78c7a999bded00000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000057465737435000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000574657374350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 --sourceChain axelar --sourceAddress axelar13ehuhysn5mqjeaheeuew2gjs785f6k7jm8vfsqg3jhtpkwppcmzqtedxty --messageId 0x1c297d6a2522aa9263d4ac034252486284d58f0c9badf1f0beb009b27c37ab1f-298 --destination 0x549Ec0Df306248e2AbDa6e71a0C0aDf3c9FB7886

```

- [ ] Deploy Remote Canonical Token

```bash
node stellar/its.js register-canonical-token CDLZFC3SYJYDZT7K67VZ75HPJVIEUVNIXF47ZG2FB2RMQQVU2HHGCYSC -y

node stellar/its.js deploy-remote-canonical-token CDLZFC3SYJYDZT7K67VZ75HPJVIEUVNIXF47ZG2FB2RMQQVU2HHGCYSC avalanche CDLZFC3SYJYDZT7K67VZ75HPJVIEUVNIXF47ZG2FB2RMQQVU2HHGCYSC 1 -y

axd tx wasm execute $GATEWAY '{"verify_messages":
      [{"cc_id":{
        "source_chain":"stellar",        "message_id":"0x225d577bb1fcac670c06250483f0e2026ae354d7cf0f56128de83c358be11bc8-3"},
        "destination_chain":"axelar",        "destination_address":"axelar13ehuhysn5mqjeaheeuew2gjs785f6k7jm8vfsqg3jhtpkwppcmzqtedxty",        "source_address":"CC4AGLL66N26OLIZVY5RJDGKSEY2I67PCYMJCP4ZTICAQPZ7CMX6MN7L",        "payload_hash":"f96246273a582c23100fdc1d3d0c51ee02fb2b030046cc512bed38d68b2e884f"}]
    }' $ARGS

axd tx wasm execute $GATEWAY '{"route_messages":
      [{"cc_id":{
        "source_chain":"stellar",        "message_id":"0x225d577bb1fcac670c06250483f0e2026ae354d7cf0f56128de83c358be11bc8-3"},
        "destination_chain":"axelar",        "destination_address":"axelar13ehuhysn5mqjeaheeuew2gjs785f6k7jm8vfsqg3jhtpkwppcmzqtedxty",        "source_address":"CC4AGLL66N26OLIZVY5RJDGKSEY2I67PCYMJCP4ZTICAQPZ7CMX6MN7L",        "payload_hash":"f96246273a582c23100fdc1d3d0c51ee02fb2b030046cc512bed38d68b2e884f"}]
    }' $ARGS

# execute it with axelarnet gateway
axd tx wasm execute axelar1zh7f9k0up9gtdjpqc9lhs60aujaww8nf5254zhphc7xyz56cus2s6ue8ya '{"execute":
      {"cc_id":{
        "source_chain":"stellar",        "message_id":"0x225d577bb1fcac670c06250483f0e2026ae354d7cf0f56128de83c358be11bc8-3"},
    "payload": "0000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000096176616c616e636865000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001600000000000000000000000000000000000000000000000000000000000000001c00a0cb91e6505241fd8c744cc5444fe3e0f5e18c551f5a3f09e9cfde4727a8100000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000066e6174697665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066e617469766500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
}
    }' $ARGS

axd tx wasm execute $PROVER '{"construct_proof":[{"source_chain":"axelar","message_id":"0xd8adcfdd262da322ac5350704ee50afb0a944e5bb08c9e887f11a7528e157de9-461"}]}' $ARGS

node evm/gateway.js -n avalanche --action submitProof --multisigSessionId 15

node evm/gateway.js -n avalanche --action execute --payload 0x0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000077374656c6c61720000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001600000000000000000000000000000000000000000000000000000000000000001c00a0cb91e6505241fd8c744cc5444fe3e0f5e18c551f5a3f09e9cfde4727a8100000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000066e6174697665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066e617469766500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 --sourceChain axelar --sourceAddress axelar13ehuhysn5mqjeaheeuew2gjs785f6k7jm8vfsqg3jhtpkwppcmzqtedxty --messageId 0xd8adcfdd262da322ac5350704ee50afb0a944e5bb08c9e887f11a7528e157de9-461 --destination 0x549Ec0Df306248e2AbDa6e71a0C0aDf3c9FB7886
```

- [ ] Interchain Token Transfer

```bash
node stellar/its.js interchain-transfer 0xa98974cd02e5ee3d65bff69465a00917f27176bffd72e352c11a78c7a999bded avalanche 0x549Ec0Df306248e2AbDa6e71a0C0aDf3c9FB7886 1 0x1234 CDLZFC3SYJYDZT7K67VZ75HPJVIEUVNIXF47ZG2FB2RMQQVU2HHGCYSC 1

axd tx wasm execute $GATEWAY '{"verify_messages":
      [{"cc_id":{
        "source_chain":"stellar",        "message_id":"0xa7646dec27e2328f1def6ebb6882bcc4b81fbca284f55cfb1ef1c736c5472b1b-4"},
        "destination_chain":"axelar",        "destination_address":"axelar13ehuhysn5mqjeaheeuew2gjs785f6k7jm8vfsqg3jhtpkwppcmzqtedxty",        "source_address":"CC4AGLL66N26OLIZVY5RJDGKSEY2I67PCYMJCP4ZTICAQPZ7CMX6MN7L",        "payload_hash":"803ace756b1809b2456f4fedf793a2b2703d411963360d3f55418d0fe1017713"}]
    }' $ARGS

axd tx wasm execute $GATEWAY '{"route_messages":
      [{"cc_id":{
        "source_chain":"stellar",        "message_id":"0xa7646dec27e2328f1def6ebb6882bcc4b81fbca284f55cfb1ef1c736c5472b1b-4"},
        "destination_chain":"axelar",        "destination_address":"axelar13ehuhysn5mqjeaheeuew2gjs785f6k7jm8vfsqg3jhtpkwppcmzqtedxty",        "source_address":"CC4AGLL66N26OLIZVY5RJDGKSEY2I67PCYMJCP4ZTICAQPZ7CMX6MN7L",        "payload_hash":"803ace756b1809b2456f4fedf793a2b2703d411963360d3f55418d0fe1017713"}]
    }' $ARGS

# execute it with axelarnet gateway
axd tx wasm execute axelar1zh7f9k0up9gtdjpqc9lhs60aujaww8nf5254zhphc7xyz56cus2s6ue8ya '{"execute":
      {"cc_id":{
        "source_chain":"stellar",        "message_id":"0xa7646dec27e2328f1def6ebb6882bcc4b81fbca284f55cfb1ef1c736c5472b1b-4"},
    "payload": "0000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000096176616c616e636865000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000000a98974cd02e5ee3d65bff69465a00917f27176bffd72e352c11a78c7a999bded00000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000002c0000001200000000000000000bcf3a6d6b2a4e0f5dc751703f1c4177201b6ec72a3d8b4a881e4e4c2a3ad95f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000014549ec0df306248e2abda6e71a0c0adf3c9fb78860000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
}
    }' $ARGS

axd tx wasm execute $PROVER '{"construct_proof":[{"source_chain":"axelar","message_id":"0x1d47435f80dd8c7cdfacd94ec8834b346b354f0087c9b8a305498fdd2b2bd3c2-343"}]}' $ARGS

node evm/gateway.js -n avalanche --action submitProof --multisigSessionId 12

node evm/gateway.js -n avalanche --action execute --payload 0x0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000077374656c6c61720000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000000a98974cd02e5ee3d65bff69465a00917f27176bffd72e352c11a78c7a999bded00000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000002c0000001200000000000000000bcf3a6d6b2a4e0f5dc751703f1c4177201b6ec72a3d8b4a881e4e4c2a3ad95f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000014549ec0df306248e2abda6e71a0c0adf3c9fb78860000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 --sourceChain axelar --sourceAddress axelar13ehuhysn5mqjeaheeuew2gjs785f6k7jm8vfsqg3jhtpkwppcmzqtedxty --messageId 0x1d47435f80dd8c7cdfacd94ec8834b346b354f0087c9b8a305498fdd2b2bd3c2-343 --destination 0x549Ec0Df306248e2AbDa6e71a0C0aDf3c9FB7886
```

### EVM to Stellar

- [ ] Deploy Native Interchain Token

```bash
node evm/interchainTokenFactory.js --action deployInterchainToken -n [source-chain] --destinationChain stellar --salt "salt" --name "test" --symbol "test" --decimals 18

node evm/interchainTokenFactory.js --action deployRemoteInterchainToken -n [source-chain] --destinationChain stellar --salt "salt"
```

- [ ] Deploy Remote Canonical Token

```bash
node evm/interchainTokenFactory.js --action registerCanonicalInterchainToken -n [source-chain] --destinationChain stellar --tokenAddress [token-address]

node evm/interchainTokenFactory.js --action deployRemoteCanonicalInterchainToken -n [source-chain] --destinationChain stellar --originalChain [original-chain] --tokenAddress [token-address]
```

- [ ] Interchain Token Transfer

```bash
node evm/its.js --action interchainTransfer -n [source-chain]  --destinationChain stellar --destinationAddress [destination-address] --tokenId [token-id] --amount [amount]
```
