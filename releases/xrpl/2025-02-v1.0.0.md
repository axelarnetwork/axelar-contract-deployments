# XRPL v1.0.0

|                | **Owner**                        |
| -------------- | -------------------------------- |
| **Created By** | @k4m4 <nikolas@commonprefix.com> |
| **Deployment** | @k4m4 <nikolas@commonprefix.com> |

| **Network**          | **Deployment Status** | **Date**   |
| -------------------- | --------------------- | ---------- |
| **Devnet Amplifier** | Deployed              | 2025-01-29 |
| **Stagenet**         | -                     | TBD        |
| **Testnet**          | -                     | TBD        |
| **Mainnet**          | -                     | TBD        |

## Background

Changes in the release:

This is the v1.0.0 initial release.

## Deployment

Create an `.env` config. `CHAIN` should be set to `xrpl` for mainnet, and `xrpl-2025-q1` for all other networks.

```yaml
SEED=xyz
ENV=xyz
CHAIN=xyz
```

An initial XRPL chain config needs to be added to `${ENV}.json` file under `chains` key.

#### Devnet-Amplifier

```bash
\"$CHAIN\": {
  "name": "XRPL",
  "axelarId": \"$CHAIN\",
  "rpc": "wss://s.devnet.rippletest.net:51233",
  "tokenSymbol": "XRP",
  "networkType": "testnet",
  "chainType": "xrpl",
  "finality": "1",
  "approxFinalityWaitTime": 1,
  "explorer": {
    "name": "XRPL Explorer",
    "url": "https://devnet.xrpl.org"
  }
}
```

#### Stagenet / Testnet

```bash
\"$CHAIN\": {
  "name": "XRPL",
  "axelarId": \"$CHAIN\",
  "rpc": "wss://s.altnet.rippletest.net:51233",
  "tokenSymbol": "XRP",
  "networkType": "testnet",
  "chainType": "xrpl",
  "finality": "1",
  "approxFinalityWaitTime": 1,
  "explorer": {
    "name": "XRPL Explorer",
    "url": "https://testnet.xrpl.org"
  }
}
```

#### Mainnet

```bash
"xrpl": {
  "name": "XRPL",
  "axelarId": "xrpl",
  "rpc": "wss://s1.ripple.com:51233",
  "tokenSymbol": "XRP",
  "networkType": "mainnet",
  "chainType": "xrpl",
  "finality": "1",
  "approxFinalityWaitTime": 1,
  "explorer": {
    "name": "XRPL Explorer",
    "url": "https://livenet.xrpl.org"
  }
}
```

1. Request tokens from faucet

```bash
node xrpl/faucet.js
```

2. Deploy XRPL Multisig account (edge AxelarGateway equivalent)

```bash
node xrpl/deploy-multisig.js --initialSigners r4LDyA6WoyzJ6ZhQ5NWU4AG1aApBwbSSr4LDyA6WoyzJ6ZhQ5NWU4AG1aApBwbSSk6
```

3. After creating the XRPL Multisig, ensure that you deploy the [XRPL Amplifier contracts](../cosmwasm/2025-02-XRPL-v1.0.0.md)

4. Set genesis verifier set

```bash
axelard tx wasm execute $XRPL_MULTISIG_PROVER '"update_verifier_set"' "${ARGS[@]}"
```

5. Register XRPL Multisig on ITS Hub

ITS hub contract configuration in `$ENV.json` must include the following attributes per chain:

```bash
"axelar": {
  "contracts": {
    ...
    "InterchainTokenService": {
      ...
      \"$CHAIN\": {
        "maxUintBits": 256,
        "maxDecimalsWhenTruncating": 255
      }
    }
    ...
  }
}
```

Please refer to `$DEPOSIT_VALUE` and `$RUN_AS_ACCOUNT` from [XRPL Amplifier](../cosmwasm/2025-02-XRPL-v1.0.0.md).

```bash
node cosmwasm/submit-proposal.js \
    its-hub-register-chains $CHAIN \
    -t "Register $CHAIN on ITS Hub" \
    -d "Register $CHAIN on ITS Hub" \
    --deposit $DEPOSIT_VALUE \
    --runAs $RUN_AS_ACCOUNT
```

6. Set XRPL as trusted chain on EVM ITS. Similarly, set XRPL as a trusted chain for every other non EVM ITS contract

```bash
# Change `PRIVATE_KEY and `ENV` in `.env` from XRPL to EVM
node evm/its.js -n all --action setTrustedAddress --trustedChain $CHAIN --trustedAddress hub
```

## Checklist

The following checks should be performed after the rollout:

### XRPL → EVM GMP/ITS call

1. Send a GMP and/or ITS call

```bash
node xrpl/transfer.js send [token] [amount] [destination-chain] [destination-address] --gas-fee-amount [gas-fee-amount] --payload [payload]
```

2. Route GMP call via Amplifier

- https://docs.axelar.dev/dev/amplifier/chain-integration/relay-messages

3. Submit proof with multisig session id

```bash
# Change `PRIVATE_KEY and `ENV` in `.env` from XRPL to EVM
node evm/gateway.js -n [destination-chain] --action submitProof --multisigSessionId [multisig session id]
```

4. Confirm whether the message is approved

```bash
node evm/gateway.js -n [destination-chain] --action isContractCallApproved --commandID [command-id] --sourceChain $CHAIN --sourceAddress [source-address] --destination [destination-address] --payloadHash 0x1ac7d1b81b7ba1025b36ccb86723da6ee5a87259f1c2fd5abe69d3200b512ec8
```

### EVM → XRPL ITS call

1. Deploy Native Interchain Token

```bash
node evm/interchainTokenFactory.js --action deployInterchainToken -n [source-chain] --destinationChain $CHAIN --salt "salt" --name "test" --symbol "TEST" --decimals 18

node evm/interchainTokenFactory.js --action deployRemoteInterchainToken -n [source-chain] --destinationChain $CHAIN --salt "salt" --deployer [deployer-address]
```

2. Interchain Token Transfer for Native Interchain Token

```bash
node evm/its.js --action interchainTransfer -n [source-chain] --destinationChain $CHAIN --destinationAddress [encoded-recipient] --tokenId [token-id] --amount [amount]
```

3. Deploy Remote Canonical Token

```bash
node evm/interchainTokenFactory.js --action registerCanonicalInterchainToken -n [source-chain] --destinationChain $CHAIN --tokenAddress [token-address]

node evm/interchainTokenFactory.js --action deployRemoteCanonicalInterchainToken -n [source-chain] --destinationChain $CHAIN --tokenAddress [token-address]
```

4. Interchain Token Transfer for Canonical Token

```bash
node evm/its.js --action interchainTransfer -n [source-chain] --destinationChain $CHAIN --destinationAddress [encoded-recipient] --tokenId [token-id] --amount [amount]
```
