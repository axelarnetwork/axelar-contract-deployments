# Interchain Governance Documentation

## Overview

The Interchain Governance system enables cross-chain governance actions for contracts like `AxelarGateway`, `InterchainTokenService`, and `InterchainTokenFactory`. Governance is controlled by the native PoS-based governance mechanism on the Axelar network.


## Governance Flow

```
1. Proposal Generation & Submission → Create proposal JSON with contract calls and submit to Axelar 
   ↓
2. Voting Period → Validators vote on proposal
   ↓
3. Proposal Passes → GMP call initiated from Axelar
   ↓
4. Relayer Executes → Proposal scheduled on EVM chain with ETA
   ↓
5. Timelock Period → Minimum delay enforced 
   ↓
6. Execution → Permissionless
```

**Key Points:**
- Proposals are created on Axelar and executed on EVM chains via GMP
- Timelock ensures minimum delay between scheduling and execution
- Each proposal is uniquely identified by `keccak256(target, calldata, nativeValue)`

## Proposal Structure

The proposal JSON generated by the script has the following structure:

```json
{
  "title": "Interchain Governance Proposal",
  "description": "Interchain Governance Proposal",
  "contract_calls": [
    {
      "chain": "ethereum",
      "contract_address": "0x...",
      "payload": "base64-encoded-payload"
    }
  ]
}
```

**Field Descriptions:**
- `title`: A string containing the proposal title (defaults to "Interchain Governance Proposal").
- `description`: A string containing the proposal description (defaults to "Interchain Governance Proposal").
- `contract_calls`: An array, where each item is an object representing a contract call:
  - `chain`: The Axelar chain ID as a string (e.g., "ethereum", "avalanche").
  - `contract_address`: The address of the governance contract on the target chain (string).
  - `payload`: A base64-encoded string containing the governance command payload. Decoded, the payload consists of:
    - Command type (uint256): One of:
        - `0` = ScheduleTimelock
        - `1` = CancelTimelock
        - `2` = ApproveOperator
        - `3` = CancelOperator
    - Target address (address): The contract on the EVM chain where the proposal will be executed.
    - Calldata (bytes): Encoded data for the function call.
    - Native value (uint256): The amount of native tokens to send with the call.
    - ETA (uint256): The unix timestamp (seconds) after which the proposal can be executed.

## Submission Methods

### Prerequisites

Setup `.env` file

```bash
PRIVATE_KEY=0x...
CHAINS=
ENV=
MNEMONIC=  # required for proposal submission 
```

**Method 1: Direct Submission (Recommended)**
```bash
# Set MNEMONIC in .env file (see Prerequisites section)
ts-node evm/governance.js schedule upgrade 2025-12-31T12:00:00 \
  --targetContractName AxelarGateway
```

**Method 2: File + Cosmos CLI**
```bash
# Generate file
ts-node evm/governance.js schedule upgrade 2025-12-31T12:00:00 \
  --targetContractName AxelarGateway --file proposal.json

# Submit via CLI
axelard tx gov submit-proposal call-contracts proposal.json \
  --deposit <min-deposit>uaxl --from <wallet> --chain-id <chain-id> \
  --gas auto --gas-adjustment 1.4 --node <rpc>
```

**Note:** The minimum deposit can be found via `axelard q gov params` and `axelard q axelarnet params` (if a higher deposit override is set for the specific contract).

## Commands

### Schedule Proposal

Schedule a new timelock proposal. Generates a proposal JSON for submission to Axelar.

```bash
ts-node evm/governance.js schedule <action> <date> [options]
```

**Actions:** `raw`, `upgrade`, `transferGovernance`, `withdraw`

- `raw`: Schedule a custom governance action by providing the target address and calldata directly. Use this for arbitrary function calls that aren't covered by other actions.
- `upgrade`: Upgrade a contract to a new implementation (requires `--targetContractName`)
- `transferGovernance`: Transfer governance of a contract (requires `--targetContractName`)
- `withdraw`: Withdraw native tokens from the governance contract (requires `--target` and `--amount`)

**Date Format:** `YYYY-MM-DDTHH:mm:ss` (UTC format, e.g., `2025-12-31T12:00:00`)

**Examples:**
```bash
# Schedule gateway upgrade 
ts-node evm/governance.js schedule upgrade 2025-12-31T12:00:00 \
  --targetContractName AxelarGateway

# Raw action - custom function call
ts-node evm/governance.js schedule raw 2025-12-31T12:00:00 \
  --target 0x1234... --calldata 0xabcd...
```


### Cancel Proposal

Cancel a scheduled timelock proposal before execution.

```bash
ts-node evm/governance.js cancel <action> [options]
```

**Options:** Same as `schedule` command (except `--file` and date argument). All options from `schedule` are available.

### Check Proposal ETA

Query the execution time for a scheduled proposal.

```bash
ts-node evm/governance.js eta --target <address> --calldata <hex>
# OR
ts-node evm/governance.js eta --proposal <encoded>
```


### Submit Proposal (if relayers fail to submit)

Manually submit a proposal when relayers haven't executed the GMP call automatically.

```bash
ts-node evm/governance.js submit <action> <commandId> <date> [options]
```

**Note:** This command calls `governance.execute()` directly on the EVM chain when relayers fail to execute automatically.

**How to Find the `commandId` from Axelarscan:**

1. Go to https://axelarscan.io/gmp/search
2. Apply filters:
   - **Source Chain**: Select `axelar`
   - **Method**: Call Contract
3. Find the most recent GMP call that matches your proposal (sender - Axelar Governance)
4. Open the transaction details and locate the `commandId` in the see more section (32-byte hex string, e.g., `0x...`)
5. **Verification**: Cross-check the sender address in the GMP call details. The sender should be the Axelar Coordinator contract address (the governance address configured in the `InterchainGovernance` contract on the destination chain). This ensures the GMP call originated from the correct governance source.

### Execute Proposal

Execute a scheduled proposal after the timelock period has passed.

```bash
ts-node evm/governance.js execute --target <address> --calldata <hex>
# OR
ts-node evm/governance.js execute --proposal <encoded>
```



## AxelarServiceGovernance Commands

`AxelarServiceGovernance` adds operator approval functionality (bypasses timelock). Only available for `AxelarServiceGovernance`:

### Schedule Operator Proposal

```bash
ts-node evm/governance.js schedule-operator <target> <calldata> <date> [options]
```

### Cancel Operator Proposal

```bash
ts-node evm/governance.js cancel-operator <target> <calldata> [options]
```


### Submit Operator Proposal

```bash
ts-node evm/governance.js submit-operator <target> <calldata> <commandId> <date> [options]
```


## Common Workflows

### End-to-End Contract Upgrade Workflow

This section provides a complete step-by-step guide for upgrading contracts (AxelarGateway, InterchainTokenService, or AxelarGasService) using interchain governance.

#### Step 1: Schedule the Upgrade Proposal

Schedule the upgrade proposal with a future execution date (ETA). The ETA must be at least `minimumTimeLockDelay` seconds in the future.

```bash
# Upgrade AxelarGateway
ts-node evm/governance.js schedule upgrade 2025-12-31T12:00:00 \
  --targetContractName AxelarGateway \
  --implementation 0xNewImplementationAddress

# Upgrade InterchainTokenService
ts-node evm/governance.js schedule upgrade 2025-12-31T12:00:00 \
  --targetContractName InterchainTokenService \
  --implementation 0xNewImplementationAddress

# Upgrade AxelarGasService
ts-node evm/governance.js schedule upgrade 2025-12-31T12:00:00 \
  --targetContractName AxelarGasService \
  --implementation 0xNewImplementationAddress
```

**Note:** If `--implementation` is not provided, the script will use the implementation address from the chain configuration **only for `AxelarGateway`**. For other contracts (InterchainTokenService, AxelarGasService), you **must** provide the `--implementation` address.

#### Step 2: Submit to Axelar

The proposal will be submitted automatically if `MNEMONIC` is set in `.env`, or submit via Cosmos CLI as shown in the "Submission Methods" section above.

#### Step 3: Wait for Voting Period

Wait for validators and the community to vote on the proposal. Monitor the proposal status on Axelarscan or via:

```bash
axelard q gov proposal <proposal-id> --node <rpc>
```

#### Step 4: Check if GMP Call Was Executed

After the proposal passes, a GMP call should be automatically executed by relayers. Check Axelarscan:

1. Go to https://axelarscan.io/gmp/search
2. Filter by:
   - **Source Chain**: `axelar`
   - **Method**: `Call Contract`
   - **Destination Chain**: Your target chain
3. Look for the most recent GMP call matching your proposal

#### Step 5: Manual Submission

If relayers didn't execute the GMP call automatically, manually submit it:

```bash
# Get the commandId from Axelarscan (see Step 4)
ts-node evm/governance.js submit upgrade <commandId> 2025-12-31T12:00:00 \
  --targetContractName AxelarGateway \
  --implementation 0xNewImplementationAddress
```

#### Step 6: Check Proposal ETA and Verify It Has Passed

After the proposal is scheduled on the EVM chain, check when it can be executed. You need to provide the same `target` and `calldata` that were used when scheduling the proposal:

```bash
# Using target and calldata directly
ts-node evm/governance.js eta --target 0xGatewayAddress --calldata 0xCalldataHex

# OR using --proposal (if you have the encoded governance proposal payload)
# The proposal payload is the encoded governance command: encode(commandType, target, calldata, nativeValue, eta)
ts-node evm/governance.js eta --proposal 0xEncodedProposalPayload
```

**Note:** The `eta` command requires explicit `--target` and `--calldata` (or `--proposal`). It does not support `--targetContractName` because it needs the exact calldata to compute the proposal hash.


**Important:** If the current time is less than the ETA, wait until the ETA passes. The script will show a warning if you try to execute too early.

#### Step 7: Execute the Proposal

Once the ETA has passed, execute the proposal. You need to provide the same `target` and `calldata` that were used when scheduling:

```bash
# Using target and calldata directly
ts-node evm/governance.js execute --target 0xGatewayAddress --calldata 0xCalldataHex

# OR using --proposal (if you have the encoded proposal payload)
ts-node evm/governance.js execute --proposal 0xEncodedProposalPayload
```

**Note:** The `execute` command requires explicit `--target` and `--calldata` (or `--proposal`). It does not support `--targetContractName` because it needs the exact calldata to compute the proposal hash.

#### Step 8: Cancel Proposal (if needed)

If you need to cancel a scheduled proposal before execution:

```bash
# Cancel before ETA passes
ts-node evm/governance.js cancel upgrade \
  --targetContractName AxelarGateway \
  --implementation 0xNewImplementationAddress
```

**Note:** You can only cancel proposals that haven't reached their ETA yet.

---

### Raw Commands: Generating Calldata for Custom Functions

The `raw` action allows you to execute any function on any contract through governance. This section explains how to generate calldata for common raw commands.

#### Understanding Calldata Generation

Calldata is the encoded function call data. You can generate it using ethers.js or the contract's ABI.


#### Example 1: Set Trusted Address for InterchainTokenService

The `setTrustedAddress` function allows setting a trusted address for a specific chain on ITS.

**Function Signature:**
```solidity
function setTrustedAddress(string memory chain, string memory address_) external onlyOwner
```

**Generate Calldata:**

```bash
# Generate calldata using ethers Interface (recommended method)
CALLDATA=$(
  node -e "
    const { utils: { Interface } } = require('ethers');
    const iface = new Interface(['function setTrustedAddress(string,string)']);
    console.log(iface.encodeFunctionData('setTrustedAddress', ['ethereum', '0x1234567890123456789012345678901234567890']));
  "
)
echo "Calldata: $CALLDATA"
```

**Submit via Governance:**

```bash
# Step 1: Schedule the proposal
ts-node evm/governance.js schedule raw 2025-12-31T12:00:00 \
  --target 0xInterchainTokenServiceAddress \
  --calldata 0xGeneratedCalldata

# Step 2: Wait for voting period and proposal to pass

# Step 3: Check if GMP was executed (check Axelarscan)
# If relayers failed, manually submit:
ts-node evm/governance.js submit raw <commandId> 2025-12-31T12:00:00 \
  --target 0xInterchainTokenServiceAddress \
  --calldata 0xGeneratedCalldata

# Step 4: After proposal is scheduled, check ETA
# Note: You must use the same target and calldata used when scheduling
ts-node evm/governance.js eta \
  --target 0xInterchainTokenServiceAddress \
  --calldata 0xGeneratedCalldata

# Step 5: Execute after ETA passes
# Note: You must use the same target and calldata used when scheduling
ts-node evm/governance.js execute \
  --target 0xInterchainTokenServiceAddress \
  --calldata 0xGeneratedCalldata
```

#### Example 2: Transfer Mint Limiter for AxelarGateway

The `transferMintLimiter` function transfers the mint limiter role to a new address.

**Function Signature:**
```solidity
function transferMintLimiter(address newMintLimiter) external override onlyMintLimiter
```

**Generate Calldata:**

```bash
# Generate calldata using ethers Interface
CALLDATA=$(
  node -e "
    const { utils: { Interface } } = require('ethers');
    const iface = new Interface(['function transferMintLimiter(address)']);
    console.log(iface.encodeFunctionData('transferMintLimiter', ['0x1234567890123456789012345678901234567890']));
  "
)
echo "Calldata: $CALLDATA"
```

**Submit via Governance:**

```bash
# Step 1: Schedule the proposal
ts-node evm/governance.js schedule raw 2025-12-31T12:00:00 \
  --target 0xAxelarGatewayAddress \
  --calldata 0xGeneratedCalldata

# Step 2: Wait for voting period and proposal to pass

# Step 3: Check if GMP was executed (check Axelarscan)
# If relayers failed, manually submit:
ts-node evm/governance.js submit raw <commandId> 2025-12-31T12:00:00 \
  --target 0xAxelarGatewayAddress \
  --calldata 0xGeneratedCalldata

# Step 4: After proposal is scheduled, check ETA
# Note: You must use the same target and calldata used when scheduling
ts-node evm/governance.js eta \
  --target 0xAxelarGatewayAddress \
  --calldata 0xGeneratedCalldata

# Step 5: Execute after ETA passes
# Note: You must use the same target and calldata used when scheduling
ts-node evm/governance.js execute \
  --target 0xAxelarGatewayAddress \
  --calldata 0xGeneratedCalldata
```

#### Complete Raw Command Workflow

1. **Generate Calldata:**
   ```bash
   CALLDATA=$(
     node -e "
       const { utils: { Interface } } = require('ethers');
       const iface = new Interface(['function yourFunctionName(type1,type2)']);
       console.log(iface.encodeFunctionData('yourFunctionName', [param1, param2]));
     "
   )
   echo "Calldata: $CALLDATA"
   ```

2. **Schedule Proposal:**
   ```bash
   ts-node evm/governance.js schedule raw 2025-12-31T12:00:00 \
     --target <contractAddress> \
     --calldata <generatedCalldata>
   ```

3. **Submit to Axelar** (automatic if `MNEMONIC` is set, or via Cosmos CLI)

4. **Wait for Voting & GMP Execution**

5. **Manual Submit (if relayers failed):**
   ```bash
   ts-node evm/governance.js submit raw <commandId> 2025-12-31T12:00:00 \
     --target <contractAddress> \
     --calldata <generatedCalldata>
   ```

6. **Check ETA:**
   ```bash
   ts-node evm/governance.js eta --target <contractAddress> --calldata <generatedCalldata>
   ```

7. **Execute after ETA:**
   ```bash
   ts-node evm/governance.js execute --target <contractAddress> --calldata <generatedCalldata>
   ```

---

### Transfer Ownership of AxelarAmplifierGateway (AMP Gateway)

AxelarAmplifierGateway uses the `Ownable` pattern. To transfer ownership via governance, use the `transferOwnership` function.

**Function Signature:**
```solidity
function transferOwnership(address newOwner) external virtual onlyOwner
```

#### Step 1: Generate Calldata

```bash
# Generate calldata using ethers Interface
CALLDATA=$(
  node -e "
    const { utils: { Interface } } = require('ethers');
    const iface = new Interface(['function transferOwnership(address)']);
    console.log(iface.encodeFunctionData('transferOwnership', ['0x1234567890123456789012345678901234567890']));
  "
)
echo "Calldata: $CALLDATA"
```

#### Step 2: Schedule Proposal

```bash
ts-node evm/governance.js schedule raw 2025-12-31T12:00:00 \
  --target 0xAxelarAmplifierGatewayAddress \
  --calldata 0xGeneratedCalldata
```

#### Step 3: Submit to Axelar

The proposal will be submitted automatically if `MNEMONIC` is set in `.env`, or submit via Cosmos CLI as shown in previous examples.

#### Step 4: Wait for Voting Period

Wait for validators and the community to vote on the proposal.

#### Step 5: Check if GMP Call Was Executed

After the proposal passes, a GMP call should be automatically executed by relayers. Check Axelarscan. If relayers failed, manually submit:

```bash
ts-node evm/governance.js submit raw <commandId> 2025-12-31T12:00:00 \
  --target 0xAxelarAmplifierGatewayAddress \
  --calldata 0xGeneratedCalldata
```

#### Step 6: Check ETA

```bash
# Note: You must use the same target and calldata used when scheduling
ts-node evm/governance.js eta \
  --target 0xAxelarAmplifierGatewayAddress \
  --calldata 0xGeneratedCalldata
```

#### Step 7: Verify ETA Has Passed

Ensure current time >= ETA before executing.

#### Step 8: Execute Proposal

```bash
# Note: You must use the same target and calldata used when scheduling
ts-node evm/governance.js execute \
  --target 0xAxelarAmplifierGatewayAddress \
  --calldata 0xGeneratedCalldata
```

#### Step 9: Verify Ownership Transfer

After execution, verify the new owner using the ownership script:

```bash
# Check the current owner
ts-node evm/ownership.js -c AxelarAmplifierGateway --action owner

# The output should show the new owner address
```

Alternatively, you can query the contract directly using any Ethereum tool or library to call the `owner()` function.

**Note:** For AMP Gateway, you can also use `proposeOwnership` followed by `acceptOwnership` if the new owner needs to accept the transfer. However, for governance-controlled transfers, `transferOwnership` is the direct method.

---

### Other Common Workflows

**Transfer Governance:**
```bash
ts-node evm/governance.js schedule transferGovernance 2025-12-31T12:00:00 \
  --targetContractName AxelarGateway --newGovernance 0xNewAddress
```

**Withdraw Tokens:**
```bash
ts-node evm/governance.js schedule withdraw 2025-12-31T12:00:00 \
  --target 0xRecipient --amount 1.0
```


## Troubleshooting

| Error | Solution |
|-------|----------|
| "Proposal already exists" | Cancel existing proposal or use different parameters |
| "TimeLock proposal is not yet eligible" | Wait until ETA passes |
| "Proposal does not exist" | Check if GMP call was executed successfully |
| "Invalid governance action for InterchainGovernance" | Use `-c AxelarServiceGovernance` for operator commands |

