# Governance Documentation

## Overview

The Interchain Governance system enables cross-chain governance actions for contracts like `AxelarGateway`, `InterchainTokenService`, and `AxelarGasService`. Governance is controlled by the native governance mechanism on the Axelar network.

For complete end-to-end examples and contract-specific recipes, see the separate [governance workflow guide](governance-workflows.md).

## Governance Flow

```
1. Proposal Generation & Submission → Create proposal JSON with contract calls and submit to Axelar
   ↓
2. Voting Period → Validators vote on proposal
   ↓
3. Proposal Passes → GMP call initiated from Axelar
   ↓
4. Relayer Executes → Proposal scheduled on EVM chain with ETA
   ↓
5. Timelock Period → Minimum delay enforced
   ↓
6. Execution → Permissionless
```

**Key Points:**

- Proposals are created on Axelar and executed on EVM chains via GMP.
- Timelock ensures a minimum delay between scheduling and execution (can be skipped using AxelarServiceGovernance operator approval).
- Each proposal is uniquely identified by `keccak256(target, calldata, nativeValue)`.

## Proposal Structure

The proposal JSON generated by the script has the following structure:

```json
{
    "title": "Interchain Governance Proposal",
    "description": "Interchain Governance Proposal",
    "contract_calls": [
        {
            "chain": "ethereum",
            "contract_address": "0x...",
            "payload": "base64-encoded-payload"
        }
    ]
}
```

**Field Descriptions:**

- `title`: A string containing the proposal title (defaults to "Interchain Governance Proposal").
- `description`: A string containing the proposal description (defaults to "Interchain Governance Proposal").
- `contract_calls`: An array, where each item is an object representing a contract call:
    - `chain`: The Axelar chain ID as a string (e.g., "ethereum", "avalanche").
    - `contract_address`: The address of the governance contract on the target chain (string).
    - `payload`: A base64-encoded string containing the governance command payload. Decoded, the payload consists of:
        - Command type (uint256): One of:
            - `0` = ScheduleTimelock
            - `1` = CancelTimelock
            - `2` = ApproveOperator
            - `3` = CancelOperator
        - Target address (address): The contract on the EVM chain where the proposal will be executed.
        - Calldata (bytes): Encoded data for the function call.
        - Native value (uint256): The amount of native tokens to send with the call.
        - ETA (uint256): The unix timestamp (seconds) after which the proposal can be executed.

## Submission Methods

### Prerequisites

Setup `.env` file

```bash
PRIVATE_KEY=0x...
CHAINS=
ENV=
MNEMONIC=  # required for proposal submission
```

**Method 1: Direct Submission (Recommended)**

```bash
# Set MNEMONIC in .env file (see Prerequisites section)
ts-node evm/governance.js schedule upgrade <activationTime> \
  --targetContractName AxelarGateway
```

**Method 2: File + Cosmos CLI**

```bash
# Generate file
ts-node evm/governance.js schedule upgrade <activationTime> \
  --targetContractName AxelarGateway --file proposal.json

# Submit via CLI
axelard tx gov submit-proposal call-contracts proposal.json \
  --deposit <min-deposit>uaxl --from <wallet> --chain-id <chain-id> \
  --gas auto --gas-adjustment 1.4 --node <rpc>
```

**Note:** The minimum deposit can be found via `axelard q gov params` and `axelard q axelarnet params` (if a higher deposit override is set for the specific contract).

## Commands

### Schedule Proposal

Schedule a new timelock proposal. Generates a proposal JSON for submission to Axelar.

```bash
ts-node evm/governance.js schedule <action> <activationTime> [options]
```

**Actions:** `raw`, `upgrade`, `transferGovernance`, `withdraw`

- `raw`: Schedule a custom governance action by providing the target address and calldata directly. Use this for arbitrary function calls that aren't covered by other actions (including advanced InterchainTokenService operations).
- `upgrade`: Upgrade a contract to a new implementation (requires `--targetContractName`)
- `transferGovernance`: Transfer governance of a contract (requires `--targetContractName`)
- `withdraw`: Withdraw native tokens from the governance contract (requires `--target` and `--amount`)

**Activation Time Format:**

- **Absolute**: `YYYY-MM-DDTHH:mm:ss` (UTC), for example `2025-12-31T12:00:00`
- **Relative**: numeric seconds (e.g., `3600` for “1 hour from now”)

**Examples:**

```bash
# Schedule gateway upgrade
ts-node evm/governance.js schedule upgrade <activationTime> \
  --targetContractName AxelarGateway

# Raw action - custom function call
ts-node evm/governance.js schedule raw <activationTime> \
  --target 0x1234... --calldata 0xabcd...
```

### Cancel Proposal

Cancel a scheduled timelock proposal before execution.

```bash
ts-node evm/governance.js cancel <action> [options]
```

**Options:** Same as `schedule` command (except `--file` and date argument). All options from `schedule` are available.

### Check Proposal ETA

Query the execution time for a scheduled proposal.

```bash
ts-node evm/governance.js eta --target <address> --calldata <hex>
# OR
ts-node evm/governance.js eta --proposal <encoded>
```

### Submit Proposal (if relayers fail to submit)

Manually submit a proposal when relayers haven't executed the GMP call automatically.

```bash
ts-node evm/governance.js submit <action> <commandId> <activationTime> [options]
```

**Note:** This command calls `governance.execute()` directly on the EVM chain when relayers fail to execute automatically.

**How to Find the `commandId` from Axelarscan:**

1. Go to https://axelarscan.io/gmp/search
2. Apply filters:
    - **Source Chain**: Select `axelar`
    - **Method**: Call Contract
3. Find the most recent GMP call that matches your proposal (sender - Axelar Governance)
4. Open the transaction details and locate the `commandId` in the see more section (32-byte hex string, e.g., `0x...`)
5. **Verification**: Cross-check the sender address in the GMP call details. The sender should be the Axelar Coordinator contract address (the governance address configured in the `InterchainGovernance` contract on the destination chain). This ensures the GMP call originated from the correct governance source.

### Execute Proposal

Execute a scheduled proposal after the timelock period has passed.

```bash
ts-node evm/governance.js execute --target <address> --calldata <hex>
# OR
ts-node evm/governance.js execute --proposal <encoded>
```

## Parallel Execution (`--parallel`) and Multi-Chain Proposals

Most EVM scripts accept a **`--parallel`** flag (via shared CLI utilities) when running over multiple chains
(`--chainNames` or `CHAINS`). When combined with `--governance`, this affects how proposals are built:

- The script runs against all selected chains concurrently.
- For each successful chain, a separate `contract_calls` entry is appended to the **same** proposal JSON.
- The final proposal therefore contains **one Axelar governance proposal** with **multiple EVM contract calls**.

Use `--parallel` when you want to schedule the **same logical change** (for example, updating trusted chains or transferring operatorship) on many chains in one governance proposal, while still benefiting from concurrent execution of the EVM helper script itself.


## AxelarServiceGovernance (Service Governance)

`AxelarServiceGovernance` is an alternative governance contract used for Axelar-operated services (for example, `AxelarGasService` or other service contracts are configured to use it). Instead of enforcing an on-chain timelock, it introduces **operator proposals** that are approved or rejected by a designated EVM-side operator.

**Key characteristics of service governance:**

- **Faster execution:** Once the Axelar governance proposal has been executed and the operator has approved it, the proposal can be executed without waiting for a timelock.
- **Same Axelar governance source of truth:** Proposals are still created and voted on through the Axelar PoS governance system; `AxelarServiceGovernance` only changes how they are gated on the destination chain.
- **Contract selection:** All base commands (`schedule`, `cancel`, `submit`, `execute`) accept `-c AxelarServiceGovernance` to target the service governance contract instead of `InterchainGovernance`.

### Schedule Operator Proposal

Schedule an operator proposal governed by `AxelarServiceGovernance`.

```bash
ts-node evm/governance.js schedule-operator <target> <calldata> <activationTime> [options]
```

- **`target`**: Address of the contract the operator proposal will call.
- **`calldata`**: Encoded function calldata.
- **`activationTime`**: Abosolute UTC timestamp ie `YYYY-MM-DDTHH:mm:ss` or relative seconds i.e `3600` (60 mins from now).
- **Notes:**
  - The command generates an `ApproveOperator` payload.
  - Use `--file` to write the generated Axelar proposal JSON instead of submitting immediately.

### Cancel Operator Proposal

Cancel a previously scheduled operator proposal.

```bash
ts-node evm/governance.js cancel-operator <target> <calldata> [options]
```

- Cancels the operator proposal identified by `(target, calldata, nativeValue)`.
- This generates a `CancelOperator` payload for `AxelarServiceGovernance`.

### Submit Operator Proposal (if relayers fail to submit)

Submit an operator proposal when relayers haven't submitted the GMP call automatically.

```bash
ts-node evm/governance.js submit-operator <target> <calldata> <commandId> <activationTime> [options]
```

- **`commandId`**: Same `commandId` used in the regular `submit` command (can be obtained from Axelarscan as described above).
- Manually calls `governance.execute()` on `AxelarServiceGovernance` with an `ApproveOperator` payload.

### Check Operator Approval Status

Check if an operator proposal has been approved on the destination chain.

```bash
ts-node evm/governance.js is-operator-approved <target> <calldata> [options]
```

### Execute Approved Operator Proposal

Execute an operator proposal that has already been approved.

```bash
ts-node evm/governance.js execute-operator-proposal <target> <calldata>  [options]
```

- Requires the operator proposal to be approved (otherwise it will revert).
- Forwards `nativeValue` (if non-zero) along with the call to `target`.

### Transfer AxelarServiceGovernance operatorship:

```bash
# schedule
ts-node evm/governance.js schedule transferOperatorship <YYYY-MM-DDTHH:mm:ss|relative-seconds> \
  --newOperator 0xNewOperator

# cancel
ts-node evm/governance.js cancel transferOperatorship \
  --calldata <calldata> 

# submit after vote
ts-node evm/governance.js submit transferOperatorship <commandId> <YYYY-MM-DDTHH:mm:ss|relative-seconds> \
  --calldata <calldata>
### Operator Proposal Lifecycle
```


## Troubleshooting

| Error                                                | Solution                                              |
| ---------------------------------------------------- | ----------------------------------------------------- |
| "Proposal already exists"                            | Cancel existing proposal or use different parameters  |
| "TimeLock proposal is not yet eligible"              | Wait until ETA passes                                 |
| "Proposal does not exist"                            | Check if GMP call was executed successfully           |
| "Invalid governance action for InterchainGovernance" | Use `-c AxelarServiceGovernance` for operator commands |
