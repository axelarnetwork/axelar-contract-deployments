
# Ton operational scripts

This folder contains operational scripts for the Ton AxelarGateway. It assumes an already deployed AxelarGateway.fc and an Executable.fc.

Required enviroment variables

```
MNEMONIC=
TONCENTER_API_KEY=
TON_GATEWAY_ADDRESS=
```

## Appoving a message

Run this with the hex encoded payload procuded by the Ton MultisigProver.

```bash
node ton/approveMessages.js b5ee9c7241020c0100018a000208000000280102016180000000000000000000000000000000800000000000000000000000000000000000000000000000000000000035f72a40030101c00400e2d0b0005189ac84d3a1d675847700777891dde751fa107d64837bf6337d32df679000000000000000000000000000000001703a1347517dcf4ff4af32dd7bfa298b66151cf6d4af45232efbba0fc2733290657629708795f55556e077b1aa1383c850216dff3779242ac815350e1023720b0102d005044035d25b76a49eebc07a7419b922fc11bd7bba1970b579d2a380ddd6606c5a1ff80607080900883078303563636137613134306231643338363363633461623834323537306161383632643835376539643232343733396530626132333364396434393766303430632d30001c6176616c616e6368652d66756a69005430783831653633654138463634464564423938353845423645323137364234333146426431306431654302000a0b00404a1a80a7b0326b22310dced59d8b52efddf313e77f9b48f226b69b8efedbe24d0006746f6ebf411b68
```


## Executing a message

Run this to execute an approve message

```bash
node ton/relayerExecute.js "0x05cca7a140b1d3863cc4ab842570aa862d857e9d224739e0ba233d9d497f040c-0" "avalanche-fuji" "0x81e63eA8F64FEdB9858EB6E2176B431FBd10d1eC" "48656c6c6f2066726f6d204176616c616e63686521" "0:4a1a80a7b0326b22310dced59d8b52efddf313e77f9b48f226b69b8efedbe24d" "ton" "0x35d25b76a49eebc07a7419b922fc11bd7bba1970b579d2a380ddd6606c5a1ff8"
```


## Sending a message from ton

```bash
node ton/callContract.js "eth-sepolia" "0x81e63eA8F64FEdB9858EB6E2176B431FBd10d1eC" "48656c6c6f2066726f6d204176616c616e63686521"
```


## Post Deployment (initialize signers)

```bash
node ton/initializeSigners.js '{
  "signers": [
    {
      "signer": "79607624103790023686192160900267678169386878801005916234280733090365959006096",
      "weight": "1"
    }
  ],
  "threshold": "1",
  "nonce": "0"
}'
```

## Signer Rotation
In our design signer rotation is a 2 step process. Thus we need both the proof generated by the MultisigProver but also the new signer config separately as it is not included in that proof.

```
node ton/signerRotation.js b5ee9c72410208010001c10002080000001401020040ab98abb510250ae97f3834f06829b35e08d6711dd57753b9c16307aadb4e5d5c0161800000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000000c0030202ce0405020120060700e1479b5562e8fe654f94078b112e8a98ba7901f853ae695bed7e0e3910bad049664000000000000000000000000000000019b7265c9660f8dd37e99e6c8e4e5fc020a1f0ddb9d55c3f352e826990af144485903cb41b47d6091f7c753ff5de667414be03bfe6a1d3f06513d949005a3500c800e100e841effcf3842f875c374639d2f02659f9358c26e94357c777219904954c6e0000000000000000000000000000000058f50f79ad5e03a8a6126a0ae6d85b0e9f2314ccb9686cd102309d17aafc1f8b1f54e44d38d2038ecf86b1a27e7ffc1411ee6ec7b3c4821ccb3d4e8e6b83f9c06000e110f37008f48b57e7841f4681a4d15f4d747443adf4871c8464bd5bd779019974c000000000000000000000000000000079865c87816d54b8c243712921892b693fe469293ef65388d1fc7a5c5b65727c790f0a70584e0e3bdefacb6bb05b00db4250b309d3457a99008317f652be5081608ba483f1 '{
  "signers": [
    {
      "signer": "79607624103790023686192160900267678169386878801005916234280733090365959006096",
      "weight": "1"
    }
  ],
  "threshold": "1",
  "nonce": "0"
}'
```

# Gas Service Scripts

Paying native gas for a contract call

```bash
node ton/gasService.js pay-native-gas "ethereum" "0x81e63eA8F64FEdB9858EB6E2176B431FBd10d1eC" "0x1234" "0QBc6NctNT4wc-8eweIkNo1JcSezNK9LArR_lMwMXqoq_xgw" 0.01
```
